@namespace StockTradePro.BlazorUI.Components.Shared
@using StockTradePro.BlazorUI.Services
@using StockTradePro.BlazorUI.Constants
@inject INotificationService NotificationService

<div class="notification-area">
    <span class="notification-icon position-relative">
        <span class="oi @ServiceConstants.UI.Icons.Notifications"></span>
        @if (unreadCount > 0)
        {
            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                @unreadCount
            </span>
        }
    </span>
</div>

@code {
    private int unreadCount = 0;

    protected override async Task OnInitializedAsync()
    {
        await LoadUnreadCount();
    }

    private async Task LoadUnreadCount()
    {
        try
        {
            unreadCount = await NotificationService.GetUnreadCountAsync();
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error loading unread count: {ex.Message}");
        }
    }
}